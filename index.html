<!doctype html>

<html lang="en">

<head>

  <meta charset="utf-8" />

  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>TailorMe — AI Chat</title>

  <style>

    :root { --bg:#0f1216; --panel:#171b21; --muted:#8b97a8; --text:#e8eef7; --brand:#6cc0ff; }

    *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--text);font:16px/1.5 system-ui,Segoe UI,Roboto,Helvetica,Arial}

    .wrap{max-width:820px;margin:48px auto;padding:0 16px}

    h1{font-size:32px;margin:0 0 6px} .sub{color:var(--muted);margin:0 0 20px}

    #chat{background:var(--panel);border-radius:14px;padding:16px}

    #log{height:48vh;overflow:auto;padding:8px;background:#11151a;border-radius:10px;margin-bottom:12px}

    .bubble{max-width:80%;padding:10px 12px;border-radius:12px;margin:6px 0;white-space:pre-wrap}

    .bubble.user{margin-left:auto;background:#2a3650}

    .bubble.ai{margin-right:auto;background:#1d252e}

    form{display:grid;gap:8px}

    input,textarea{width:100%;background:#0f141a;color:var(--text);border:1px solid #253041;border-radius:10px;padding:10px 12px;outline:none}

    input::placeholder, textarea::placeholder{color:#6c7a8f}

    .actions{display:flex;gap:8px;justify-content:flex-end}

    button{appearance:none;border:0;border-radius:10px;padding:10px 16px;background:var(--brand);color:#052338;font-weight:600;cursor:pointer}

    button[disabled]{opacity:.6;cursor:not-allowed}

    .note{color:var(--muted);font-size:13px;margin-top:10px}

  </style>

</head>

<body>

  <main class="wrap">

    <h1>TailorMe — AI Chat</h1>

    <p class="sub">Ask about alterations, pricing, and appointments.</p>



    <div id="chat">

      <div id="log" aria-live="polite"></div>



      <form id="form">

        <input id="name" placeholder="Your name (optional)" autocomplete="name" />

        <textarea id="msg" placeholder="Type your message…" rows="3" required></textarea>

        <div class="actions">

          <button id="clear" type="button">Clear</button>

          <button id="send" type="submit">Send</button>

        </div>

      </form>



      <p class="note">Tip: the assistant replies in the same language you write.</p>

    </div>

  </main>



  <script>

    const log = document.getElementById('log');

    const form = document.getElementById('form');

    const msg = document.getElementById('msg');

    const nameInput = document.getElementById('name');

    const sendBtn = document.getElementById('send');



    function addBubble(text, who='user'){

      const b = document.createElement('div');

      b.className = 'bubble ' + who;

      b.textContent = text;

      log.appendChild(b);

      log.scrollTop = log.scrollHeight;

    }

    function setBusy(v){ sendBtn.disabled = v; sendBtn.textContent = v ? 'Thinking…' : 'Send'; }



    document.getElementById('clear').onclick = () => { log.innerHTML = ''; msg.value=''; msg.focus(); };



    form.addEventListener('submit', async (e) => {

      e.preventDefault();

      const text = msg.value.trim();

      if(!text) return;

      const name = nameInput.value.trim();

      addBubble(text,'user');

      msg.value = '';

      setBusy(true);

      try{

        const r = await fetch('/api/chat', {

          method:'POST',

          headers:{'Content-Type':'application/json'},

          body: JSON.stringify({ message: text, name })

        });

        const data = await r.json();

        if(!r.ok) throw new Error(data.error || r.statusText);

        addBubble(data.reply || '(No reply)','ai');

      }catch(err){

        addBubble('Error: ' + err.message,'ai');

      }finally{

        setBusy(false);

      }

    });

  </script>

</body>

</html>
